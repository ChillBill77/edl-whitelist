#!/bin/bash

# Define your associative GAFAM arrays
unset GOOGLE_ARRAY
unset APPLE_ARRAY
unset FACEBOOK_ARRAY
unset AMAZON_ARRAY
unset MICROSOFT_ARRAY

GOOGLE_ARRAY+=("6432")
GOOGLE_ARRAY+=("13949")
GOOGLE_ARRAY+=("15169")
GOOGLE_ARRAY+=("16550")
GOOGLE_ARRAY+=("16591")
GOOGLE_ARRAY+=("19425")
GOOGLE_ARRAY+=("19448")
GOOGLE_ARRAY+=("19527")
GOOGLE_ARRAY+=("22577")
GOOGLE_ARRAY+=("22859")
GOOGLE_ARRAY+=("26684")
GOOGLE_ARRAY+=("26910")
GOOGLE_ARRAY+=("32381")
GOOGLE_ARRAY+=("33715")
GOOGLE_ARRAY+=("36039")
GOOGLE_ARRAY+=("36040")
GOOGLE_ARRAY+=("36383")
GOOGLE_ARRAY+=("36384")
GOOGLE_ARRAY+=("36385")
GOOGLE_ARRAY+=("36411")
GOOGLE_ARRAY+=("36492")
GOOGLE_ARRAY+=("36520")
GOOGLE_ARRAY+=("36561")
GOOGLE_ARRAY+=("36987")
GOOGLE_ARRAY+=("40873")
GOOGLE_ARRAY+=("41264")
GOOGLE_ARRAY+=("43515")
GOOGLE_ARRAY+=("45566")
GOOGLE_ARRAY+=("55023")
GOOGLE_ARRAY+=("139070")
GOOGLE_ARRAY+=("139190")
GOOGLE_ARRAY+=("214609")
GOOGLE_ARRAY+=("214611")
GOOGLE_ARRAY+=("394089")
GOOGLE_ARRAY+=("394507")
GOOGLE_ARRAY+=("394639")
GOOGLE_ARRAY+=("395973")
GOOGLE_ARRAY+=("396982")
APPLE_ARRAY+=("714")
APPLE_ARRAY+=("1036")
APPLE_ARRAY+=("1042")
APPLE_ARRAY+=("2709")
APPLE_ARRAY+=("6185")
FACEBOOK_ARRAY+=("32934")
FACEBOOK_ARRAY+=("34825")
FACEBOOK_ARRAY+=("54115")
FACEBOOK_ARRAY+=("63293")
FACEBOOK_ARRAY+=("149642")
AMAZON_ARRAY+=("699")
AMAZON_ARRAY+=("801")
AMAZON_ARRAY+=("7224")
AMAZON_ARRAY+=("8987")
AMAZON_ARRAY+=("9059")
AMAZON_ARRAY+=("10291")
AMAZON_ARRAY+=("14618")
AMAZON_ARRAY+=("16509")
AMAZON_ARRAY+=("19047")
AMAZON_ARRAY+=("21664")
AMAZON_ARRAY+=("38895")
AMAZON_ARRAY+=("39111")
AMAZON_ARRAY+=("40045")
AMAZON_ARRAY+=("46489")
AMAZON_ARRAY+=("53032")
AMAZON_ARRAY+=("62785")
AMAZON_ARRAY+=("63088")
AMAZON_ARRAY+=("214101")
AMAZON_ARRAY+=("397153")
AMAZON_ARRAY+=("399834")
AMAZON_ARRAY+=("401395")
AMAZON_ARRAY+=("10124")
AMAZON_ARRAY+=("17493")
AMAZON_ARRAY+=("36263")
AMAZON_ARRAY+=("58588")
AMAZON_ARRAY+=("135630")
AMAZON_ARRAY+=("395343")
AMAZON_ARRAY+=("399991")
AMAZON_ARRAY+=("400098")
MICROSOFT_ARRAY+=("3598")
MICROSOFT_ARRAY+=("5761")
MICROSOFT_ARRAY+=("6182")
MICROSOFT_ARRAY+=("6194")
MICROSOFT_ARRAY+=("6291")
MICROSOFT_ARRAY+=("6584")
MICROSOFT_ARRAY+=("8068")
MICROSOFT_ARRAY+=("8069")
MICROSOFT_ARRAY+=("8070")
MICROSOFT_ARRAY+=("8071")
MICROSOFT_ARRAY+=("8072")
MICROSOFT_ARRAY+=("8073")
MICROSOFT_ARRAY+=("8074")
MICROSOFT_ARRAY+=("8075")
MICROSOFT_ARRAY+=("8812")
MICROSOFT_ARRAY+=("12076")
MICROSOFT_ARRAY+=("13399")
MICROSOFT_ARRAY+=("13811")
MICROSOFT_ARRAY+=("14719")
MICROSOFT_ARRAY+=("14783")
MICROSOFT_ARRAY+=("17144")
MICROSOFT_ARRAY+=("17345")
MICROSOFT_ARRAY+=("20046")
MICROSOFT_ARRAY+=("22692")
MICROSOFT_ARRAY+=("23468")
MICROSOFT_ARRAY+=("25796")
MICROSOFT_ARRAY+=("26222")
MICROSOFT_ARRAY+=("30135")
MICROSOFT_ARRAY+=("30520")
MICROSOFT_ARRAY+=("30575")
MICROSOFT_ARRAY+=("31792")
MICROSOFT_ARRAY+=("32476")
MICROSOFT_ARRAY+=("35106")
MICROSOFT_ARRAY+=("36006")
MICROSOFT_ARRAY+=("40066")
MICROSOFT_ARRAY+=("45139")
MICROSOFT_ARRAY+=("46182")
MICROSOFT_ARRAY+=("52985")
MICROSOFT_ARRAY+=("54396")
MICROSOFT_ARRAY+=("58862")
MICROSOFT_ARRAY+=("59067")
MICROSOFT_ARRAY+=("63245")
MICROSOFT_ARRAY+=("63314")
MICROSOFT_ARRAY+=("132348")
MICROSOFT_ARRAY+=("200517")
MICROSOFT_ARRAY+=("395496")
MICROSOFT_ARRAY+=("395524")
MICROSOFT_ARRAY+=("395851")
MICROSOFT_ARRAY+=("396463")
MICROSOFT_ARRAY+=("397096")
MICROSOFT_ARRAY+=("397466")
MICROSOFT_ARRAY+=("397996")
MICROSOFT_ARRAY+=("398575")
MICROSOFT_ARRAY+=("398656")
MICROSOFT_ARRAY+=("398657")
MICROSOFT_ARRAY+=("398658")
MICROSOFT_ARRAY+=("398659")
MICROSOFT_ARRAY+=("398660")
MICROSOFT_ARRAY+=("398661")
MICROSOFT_ARRAY+=("398961")
MICROSOFT_ARRAY+=("400572")
MICROSOFT_ARRAY+=("400573")
MICROSOFT_ARRAY+=("400574")
MICROSOFT_ARRAY+=("400575")
MICROSOFT_ARRAY+=("400576")
MICROSOFT_ARRAY+=("400577")
MICROSOFT_ARRAY+=("400578")
MICROSOFT_ARRAY+=("400579")
MICROSOFT_ARRAY+=("400580")
MICROSOFT_ARRAY+=("400581")
MICROSOFT_ARRAY+=("400582")
MICROSOFT_ARRAY+=("400884") 

#Define Arrays
unset ARRAYS
ARRAYS+=("GOOGLE_ARRAY")
ARRAYS+=("APPLE_ARRAY")
ARRAYS+=("FACEBOOK_ARRAY")
ARRAYS+=("AMAZON_ARRAY")
ARRAYS+=("MICROSOFT_ARRAY")

# Loop over the Arrays
for ARRAY in "${ARRAYS[@]}"
do
	echo "# $ARRAY // Last updated $(date)" > ./$ARRAY.asn.cidr.tmp
	# Extra step needed
        CARRAY=$ARRAY[@]
	for ASN in "${!CARRAY}"
	do
   		echo "#START AS:$ASN" 
   		whois -h whois.radb.net -- "-i origin AS$ASN" | awk '/^route:/ {print $2;}' | sort | uniq >> ./$ARRAY.asn.cidr.tmp
	done
	cat ./$ARRAY.asn.cidr.tmp | sort | uniq -u > ./lists/$ARRAY.asn.cidr
	rm -f ./$ARRAY.asn.cidr.tmp
done